{
  "hash": "538e950ccb97bd05db9d9b90038b601f",
  "result": {
    "markdown": "---\ntitle: \"Extract of UK Frigates and Their Precendents\"\ndescription: \"This post shows how to access the wikipedia knowledge graph\"\nauthor: \"Luke Heley\"\ndate: \"26 March 2023\"\nfreeze: true\nformat:\n  html:\n    toc: true\ncategories:\n - wikipedia\n - scrape\neditor_options:\n  chunk_output_type: console\n---\n\n\n# Objective\n\nExtract list of UK Frigates and their precedents.\n\n# Data\n\nWe use wikidata to first extract the different types of warship\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq <- '\nSELECT ?ship_type ?ship_typeLabel WHERE {\n  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }\n  ?ship_type wdt:P31 wd:Q2235308;\n    wdt:P279 wd:Q3114762.\n  \n  OPTIONAL {  }\n}\n  '\n\nWikidataQueryServiceR::query_wikidata(q)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 55 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): ship_type, ship_typeLabel\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 55 × 2\n   ship_type                              ship_typeLabel  \n   <chr>                                  <chr>           \n 1 http://www.wikidata.org/entity/Q17205  aircraft carrier\n 2 http://www.wikidata.org/entity/Q104843 cruiser         \n 3 http://www.wikidata.org/entity/Q161705 frigate         \n 4 http://www.wikidata.org/entity/Q170013 corvette        \n 5 http://www.wikidata.org/entity/Q174736 destroyer       \n 6 http://www.wikidata.org/entity/Q182531 battleship      \n 7 http://www.wikidata.org/entity/Q188924 galley          \n 8 http://www.wikidata.org/entity/Q207452 ship of the line\n 9 http://www.wikidata.org/entity/Q629990 bireme          \n10 http://www.wikidata.org/entity/Q640078 minelayer       \n# … with 45 more rows\n```\n:::\n:::\n\n\nAnd subsequently different types of frigates operated by the Royal Navy\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq <- '\nSELECT ?ship_class ?ship_classLabel ?service_entry ?followed_by ?followed_byLabel ?operator ?operatorLabel ?image ?service_retirement ?follows ?followsLabel ?service_entryLabel ?service_retirementLabel ?imageLabel WHERE {\n  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }\n  ?ship_class wdt:P31 wd:Q559026; # instance of ship class\n    wdt:P279 wd:Q106070703. # subclass of frigate\n  ?ship_class wdt:P137 wd:Q172771. # operated by RN\n  OPTIONAL { ?ship_class wdt:P729 ?service_entry. }\n  OPTIONAL { ?ship_class wdt:P730 ?service_retirement. }\n  OPTIONAL { ?ship_class wdt:P155 ?follows. }\n  OPTIONAL { ?ship_class wdt:P156 ?followed_by. }\n  OPTIONAL { ?ship_class wdt:P137 ?operator. }\n  OPTIONAL { ?ship_class wdt:P18 ?image. }\n}\n'\nrn_frigates <- WikidataQueryServiceR::query_wikidata(q)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 83 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (10): ship_class, ship_classLabel, followed_by, followed_byLabel, opera...\ndttm  (4): service_entry, service_retirement, service_entryLabel, service_re...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrn_frigates |>\n  dplyr::filter(operatorLabel == \"Royal Navy\") |>\n  dplyr::select(from = ship_classLabel, \n                to = followed_byLabel, \n                value = service_entry) |>\n  dplyr::distinct() |>\n  dplyr::filter(!is.na(to)) |>\n  igraph::graph_from_data_frame() |>\n  visNetwork::visIgraph()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-ca0beb33a71c5962ef33\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ca0beb33a71c5962ef33\">{\"x\":{\"nodes\":{\"id\":[\"Type 21 frigate\",\"Type 22 frigate\",\"Rothesay-class frigate\",\"Type 23 frigate\",\"Leander-class frigate\",\"Van Speijk-class frigate\",\"River-class frigate\",\"Nilgiri-class frigate\",\"Whitby-class anti-submarine frigate\",\"Salisbury-class frigate\",\"Captain-class frigate\",\"Loch-class frigate\",\"Valour-class frigate\",\"Type 26 frigate\",\"Kortenaer-class frigate\",\"Tacoma-class frigate\",\"Godavari-class frigate\",\"Almirante Clemente-class destroyer\",\"Bay-class frigate\"],\"label\":[\"Type 21 frigate\",\"Type 22 frigate\",\"Rothesay-class frigate\",\"Type 23 frigate\",\"Leander-class frigate\",\"Van Speijk-class frigate\",\"River-class frigate\",\"Nilgiri-class frigate\",\"Whitby-class anti-submarine frigate\",\"Salisbury-class frigate\",\"Captain-class frigate\",\"Loch-class frigate\",\"Valour-class frigate\",\"Type 26 frigate\",\"Kortenaer-class frigate\",\"Tacoma-class frigate\",\"Godavari-class frigate\",\"Almirante Clemente-class destroyer\",\"Bay-class frigate\"],\"x\":[0.764929000005504,0.791188396363633,0.113740083423222,0.960799734241349,0.431346068604542,0.445545827153973,-0.930167949566303,-0.829335676150508,-0.246093442640915,0.201299966708137,-0.164975286375265,-0.92056551250249,0.129263534373717,1,0.5520068627316,-0.782997173506526,-1,-0.157278098056639,-0.636984324283066],\"y\":[-0.545473705591992,-0.250916801260133,-0.685457599142316,0.0576426287991509,-0.412873703411638,0.667274381710942,0.463697795929325,-0.665992833113316,-0.722716847629483,-0.121625688996889,1,0.166371442480229,-1,0.357865951858282,0.9127384112548,0.72040684130715,-0.446967901959197,0.732337572669419,0.026163586505076]},\"edges\":{\"from\":[\"Type 21 frigate\",\"Type 22 frigate\",\"Rothesay-class frigate\",\"Rothesay-class frigate\",\"Type 23 frigate\",\"Leander-class frigate\",\"Leander-class frigate\",\"Van Speijk-class frigate\",\"River-class frigate\",\"River-class frigate\",\"Nilgiri-class frigate\",\"Whitby-class anti-submarine frigate\",\"Salisbury-class frigate\",\"Captain-class frigate\",\"Loch-class frigate\"],\"to\":[\"Type 22 frigate\",\"Type 23 frigate\",\"Valour-class frigate\",\"Leander-class frigate\",\"Type 26 frigate\",\"Type 21 frigate\",\"Type 22 frigate\",\"Kortenaer-class frigate\",\"Tacoma-class frigate\",\"Loch-class frigate\",\"Godavari-class frigate\",\"Rothesay-class frigate\",\"Leander-class frigate\",\"Almirante Clemente-class destroyer\",\"Bay-class frigate\"],\"value\":[126230400,283996800,-315619200,-315619200,536457600,-220924800,-220924800,-94694400,-883612800,-883612800,63072000,-441849600,-410227200,-852076800,-820540800]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false,\"arrows\":\"to\"},\"physics\":{\"stabilization\":false}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":false},\"byselection\":{\"enabled\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nNext step. Extract data on type 26, type 23, type 22, type 21, leander class, rothesay-class, valour-class, whiteby-class and saisbury class.\n\nFuture intention is to compare to other nations where data are available.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js\"></script>\r\n<link href=\"../../site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/vis-9.1.0/vis-network.min.js\"></script>\r\n<script src=\"../../site_libs/visNetwork-binding-2.1.0/visNetwork.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}